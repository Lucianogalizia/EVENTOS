{% extends "base.html" %}

{% block title %}Intervenciones de pozos{% endblock %}

{% block content %}
<div class="row mb-4">
  <div class="col-12 col-lg-4 mb-3">
    <div class="card shadow-sm border-0 card-filter">
      <div class="card-body">
        <h5 class="card-title text-main">Filtros</h5>
        <form method="get">
          <!-- Selector de pozo -->
          <div class="mb-3">
            <label for="well" class="form-label">Pozo</label>
            <select
              class="form-select"
              id="well"
              name="well"
              onchange="this.form.submit()"
              required
            >
              <option value="" disabled {% if not pozo_sel %}selected{% endif %}>
                Seleccioná un pozo
              </option>
              {% for p in pozos %}
              <option value="{{ p }}" {% if p == pozo_sel %}selected{% endif %}>
                {{ p }}
              </option>
              {% endfor %}
            </select>
          </div>

          <!-- Selector de evento (solo si hay pozo) -->
          {% if pozo_sel %}
          <div class="mb-3">
            <label for="event" class="form-label">Evento</label>
            <select
              class="form-select"
              id="event"
              name="event"
              onchange="this.form.submit()"
            >
              <option value="" disabled {% if not evento_sel %}selected{% endif %}>
                Seleccioná un evento
              </option>
              {% for e in eventos %}
              <option value="{{ e.event_id }}" {% if e.event_id == evento_sel %}selected{% endif %}>
                {{ e.label }}
              </option>
              {% endfor %}
            </select>
          </div>
          {% endif %}
        </form>
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-8 mb-3">
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h5 class="card-title text-main">
          {% if pozo_sel and evento_sel %}
            Detalle intervención
          {% elif pozo_sel %}
            Seleccioná un evento
          {% else %}
            Seleccioná un pozo para comenzar
          {% endif %}
        </h5>

        {% if tabla_evento %}
        <div class="table-responsive mt-3">
          <table class="table table-sm table-striped align-middle mb-0 table-custom">
            <thead>
              <tr>
                {% for col in columnas %}
                <th scope="col">{{ col }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              {% for fila in tabla_evento %}
              <tr>
                {% for col in columnas %}
                <td>{{ fila[col] if fila[col] is not none else "" }}</td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        {% elif pozo_sel and not evento_sel %}
        <p class="text-muted mt-3">Elegí un evento para ver el detalle.</p>
        {% elif not pozo_sel %}
        <p class="text-muted mt-3">Usá el filtro de la izquierda para comenzar.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

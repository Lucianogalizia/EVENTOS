{% extends "base.html" %}

{% block title %}Intervenciones de pozos{% endblock %}

{% block content %}

<!-- FILTROS ARRIBA, A LO ANCHO -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card shadow-sm border-0 card-filter">
      <div class="card-body">
        <h5 class="card-title text-main">Filtros</h5>
        <form method="get" class="row g-3">
          <!-- Selector de pozo -->
          <div class="col-12 col-md-4">
            <label for="well" class="form-label">Pozo</label>
          
            <!-- Input con autocompletar -->
            <input
              class="form-control"
              id="well"
              name="well"
              list="lista-pozos"
              placeholder="Escribí o elegí un pozo"
              value="{{ pozo_sel or '' }}"
              required
            />
          
            <!-- Lista de pozos para autocompletar -->
            <datalist id="lista-pozos">
              {% for p in pozos %}
                <option value="{{ p }}"></option>
              {% endfor %}
            </datalist>
          </div>
          

          <!-- Selector de evento (solo si hay pozo) -->
          {% if pozo_sel %}
          <div class="col-12 col-md-6">
            <label for="event" class="form-label">Evento</label>
            <select
              class="form-select"
              id="event"
              name="event"
              onchange="this.form.submit()"
            >
              <option value="" disabled {% if not evento_sel %}selected{% endif %}>
                Seleccioná un evento
              </option>
              {% for e in eventos %}
              <option value="{{ e.event_id }}" {% if e.event_id == evento_sel %}selected{% endif %}>
                {{ e.label }}
              </option>
              {% endfor %}
            </select>
          </div>
          {% endif %}
        </form>
      </div>
    </div>
  </div>
</div>

<!-- DETALLE ABAJO, OCUPANDO TODO EL ANCHO -->
<div class="row mb-4">
  <div class="col-12">
    <div class="card shadow-sm border-0">
      <div class="card-body">
        <h5 class="card-title text-main">
          {% if pozo_sel and evento_sel %}
            Detalle intervención
          {% elif pozo_sel %}
            Seleccioná un evento
          {% else %}
            Seleccioná un pozo para comenzar
          {% endif %}
        </h5>

        {% if tabla_evento %}
        <!-- wrapper para poder tener barra horizontal -->
        <div class="table-scroll-wrapper">
          <div class="table-responsive mt-3">
            <table class="table table-sm table-striped align-middle mb-0 table-custom" id="detalle-intervencion">
              <thead>
                <tr>
                  {% for col in columnas %}
                  <th scope="col" {% if col == 'expr1' %}class="col-expr1"{% endif %}>
                    {{ col }}
                  </th>
                  {% endfor %}
                </tr>
              </thead>
              <tbody>
                {% for fila in tabla_evento %}
                <tr>
                  {% for col in columnas %}
                  <td{% if col == 'expr1' %} class="col-expr1"{% endif %}>
                    {{ fila[col] if fila[col] is not none else "" }}
                  </td>
                  {% endfor %}
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
        {% elif pozo_sel and not evento_sel %}
        <p class="text-muted mt-3">Elegí un evento para ver el detalle.</p>
        {% elif not pozo_sel %}
        <p class="text-muted mt-3">Usá los filtros de arriba para comenzar.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock %}





 

